[gd_scene load_steps=26 format=3 uid="uid://cobk8lnewpxif"]

[ext_resource type="Script" uid="uid://cimamf4iibvtd" path="res://line_2d.gd" id="1_81cir"]
[ext_resource type="Script" uid="uid://r1y7h7ppfe0j" path="res://level/level_scene.gd" id="1_gbniv"]
[ext_resource type="Script" uid="uid://bema7mhup8qn0" path="res://animation_player.gd" id="2_csaot"]
[ext_resource type="Script" uid="uid://dlwr37a2j3bdo" path="res://polygon_2d.gd" id="3_56yq2"]
[ext_resource type="Script" uid="uid://bxwwlyk64urqt" path="res://level/character_camera.gd" id="4_q8ubn"]
[ext_resource type="Script" uid="uid://c1n8j1ba2i8mt" path="res://level/transitioner.gd" id="5_csaot"]
[ext_resource type="PackedScene" uid="uid://cg1xca6iswg5y" path="res://level/objects/clover/clover.tscn" id="5_p86dk"]
[ext_resource type="Texture2D" uid="uid://ceymbhu4il1q0" path="res://character/sprites/ball.png" id="6_56yq2"]
[ext_resource type="PackedScene" uid="uid://bge0n8af06jnl" path="res://level/objects/collectible_placer/collectible_placer.tscn" id="6_ec8w2"]
[ext_resource type="PackedScene" uid="uid://drha351nbsdeu" path="res://level/objects/petal_placer/petal_placer.tscn" id="7_ec8w2"]
[ext_resource type="Texture2D" uid="uid://cqtsxjnqlfb5i" path="res://character/sprites/idle.png" id="7_q8ubn"]
[ext_resource type="PackedScene" uid="uid://caqbx734ke4b3" path="res://level/objects/rings/rings.tscn" id="8_ksba8"]
[ext_resource type="Script" uid="uid://tvi1ptnuyihn" path="res://level/objects/player_spawner/player_spawner.gd" id="8_q8ubn"]

[sub_resource type="Animation" id="Animation_5vw27"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(2944, -32)]
}

[sub_resource type="Animation" id="Animation_272bh"]
resource_name = "animate"
length = 8.0
loop_mode = 1
step = 1.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 3.0499997, 4, 7),
"transitions": PackedFloat32Array(-2, 1, -2, 1),
"update": 0,
"values": [Vector2(2944, -32), Vector2(2814, 320), Vector2(2814, 320), Vector2(2944, -32)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_kek77"]
_data = {
&"RESET": SubResource("Animation_5vw27"),
&"animate": SubResource("Animation_272bh")
}

[sub_resource type="Curve2D" id="Curve2D_ec8w2"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -128, 0, 0, 0, 0, 0, -128, -128, 0, 0, 0, 0, 0, -128, 0, 0, 0, 0, 0, -64, 0, 0, 0, 0, -96, -64)
}
point_count = 6

[sub_resource type="Curve2D" id="Curve2D_ksba8"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 256, -128, 0, 0, 0, 0, 768, -128, 0, 0, 0, 0, 832, -320, 0, 0, 0, 0, 608, -416, 0, 0, 0, 0, 128, -384, 0, 0, 0, 0, 32, -288, 0, 0, 0, 0, 224, -224, 0, 0, 0, 0, 576, -224, 0, 0, 0, 0, 544, -352, 0, 0, 0, 0, 352, -288)
}
point_count = 10

[sub_resource type="Curve2D" id="Curve2D_qeywc"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, -3, -2, 0, 0, 0, 0, -252, 8, 0, 0, 0, 0, -381, 153, 0, 0, 0, 0, -600, 115, 0, 0, 0, 0, -836, 64)
}
point_count = 5

[sub_resource type="AtlasTexture" id="AtlasTexture_hq3og"]
atlas = ExtResource("6_56yq2")
region = Rect2(0, 0, 48, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_orckd"]
atlas = ExtResource("7_q8ubn")
region = Rect2(0, 0, 48, 48)

[sub_resource type="SpriteFrames" id="SpriteFrames_gbniv"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_hq3og")
}],
"loop": true,
"name": &"ball",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_orckd")
}],
"loop": true,
"name": &"idle",
"speed": 5.0
}]

[sub_resource type="Animation" id="Animation_ec8w2"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:animated_zoom")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:offset")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, 0)]
}

[sub_resource type="Animation" id="Animation_p86dk"]
resource_name = "collect"
length = 3.0
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:animated_zoom")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1, 2, 2.9666667),
"transitions": PackedFloat32Array(-2, 1, -2, 1),
"update": 0,
"values": [1.0, 2.0, 2.0, 1.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".:offset")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1, 2, 3),
"transitions": PackedFloat32Array(-2, 1, -2, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(0, 48), Vector2(0, 48), Vector2(0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ksba8"]
_data = {
&"RESET": SubResource("Animation_ec8w2"),
&"collect": SubResource("Animation_p86dk")
}

[node name="TestLevel" type="Node2D" node_paths=PackedStringArray("player_spawner", "character_camera")]
script = ExtResource("1_gbniv")
player_spawner = NodePath("PlayerSpawner")
character_camera = NodePath("Camera2D")

[node name="Terrain" type="Node2D" parent="."]
z_index = 1

[node name="AnimatableBody2D" type="AnimatableBody2D" parent="Terrain"]
position = Vector2(2944, -32)

[node name="OneWay" type="CollisionPolygon2D" parent="Terrain/AnimatableBody2D"]
build_mode = 1
polygon = PackedVector2Array(-576, -192, -448, -192, -448, -160, -576, -160)
one_way_collision = true

[node name="Line2D" type="Line2D" parent="Terrain/AnimatableBody2D/OneWay" node_paths=PackedStringArray("collision_polygon")]
position = Vector2(0, 3)
width = 6.0
script = ExtResource("1_81cir")
collision_polygon = NodePath("..")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Terrain/AnimatableBody2D"]
callback_mode_process = 0
libraries = {
&"": SubResource("AnimationLibrary_kek77")
}
script = ExtResource("2_csaot")

[node name="Water" type="StaticBody2D" parent="Terrain"]
position = Vector2(9, -207)
collision_layer = 2
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Terrain/Water"]
polygon = PackedVector2Array(4023, 15, 2839, 79, 2839, 591, 4023, 591)

[node name="Polygon2D" type="Polygon2D" parent="Terrain/Water/CollisionPolygon2D" node_paths=PackedStringArray("collision_polygon")]
color = Color(0, 0.7529412, 1, 0.5019608)
script = ExtResource("3_56yq2")
collision_polygon = NodePath("..")

[node name="Water2" type="StaticBody2D" parent="Terrain"]
position = Vector2(-4256, 128)
collision_layer = 2
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Terrain/Water2"]
polygon = PackedVector2Array(3840, 32, 2752, 32, 2752, 352, 3840, 352)

[node name="Polygon2D" type="Polygon2D" parent="Terrain/Water2/CollisionPolygon2D" node_paths=PackedStringArray("collision_polygon")]
color = Color(0, 0.7529412, 1, 0.5019608)
script = ExtResource("3_56yq2")
collision_polygon = NodePath("..")

[node name="Terrain" type="StaticBody2D" parent="Terrain"]
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Terrain/Terrain"]
polygon = PackedVector2Array(-480, 96, -128, 96, 416, 192, 608, 96, 1216, 96, 1280, -32, 1568, 0, 1696, 128, 2432, 128, 2496, -224, 2912, -192, 2912, 256, 3904, 320, 3904, -448, 4704, -448, 4704, 1024, -1920, 1088, -1920, -448, -1408, -448, -1408, -192, -800, -192, -800, -32, -1088, -32, -1088, 224, -1280, 224, -1280, -32, -1440, -32, -1440, 384, -480, 384)

[node name="Polygon2D" type="Polygon2D" parent="Terrain/Terrain/CollisionPolygon2D" node_paths=PackedStringArray("collision_polygon")]
script = ExtResource("3_56yq2")
collision_polygon = NodePath("..")

[node name="OneWay" type="CollisionPolygon2D" parent="Terrain/Terrain"]
build_mode = 1
polygon = PackedVector2Array(-800, -192, -256, -192, -256, -160, -800, -160)
one_way_collision = true

[node name="Line2D" type="Line2D" parent="Terrain/Terrain/OneWay" node_paths=PackedStringArray("collision_polygon")]
position = Vector2(0, 3)
width = 6.0
script = ExtResource("1_81cir")
collision_polygon = NodePath("..")

[node name="Objects" type="Node2D" parent="."]

[node name="CloverRings" parent="Objects" instance=ExtResource("5_p86dk")]
position = Vector2(128, 32)

[node name="CloverPetals" parent="Objects" instance=ExtResource("5_p86dk")]
position = Vector2(1098, 34)

[node name="CollectiblePlacer" parent="Objects" instance=ExtResource("6_ec8w2")]
position = Vector2(-256, 32)
curve = SubResource("Curve2D_ec8w2")
collectible_count = 16

[node name="PetalPlacer" parent="Objects" node_paths=PackedStringArray("clover") instance=ExtResource("7_ec8w2")]
position = Vector2(800, 96)
curve = SubResource("Curve2D_ksba8")
clover = NodePath("../CloverPetals")
collectible_count = 10

[node name="PathFollow2D" parent="Objects/PetalPlacer" index="0"]
position = Vector2(256, -128)

[node name="Spawner" parent="Objects/PetalPlacer" index="2"]
position = Vector2(128, -64)

[node name="Rings" parent="Objects" node_paths=PackedStringArray("clover") instance=ExtResource("8_ksba8")]
position = Vector2(664, -23)
curve = SubResource("Curve2D_qeywc")
clover = NodePath("../CloverRings")

[node name="PathFollow2D" parent="Objects/Rings" index="0"]
position = Vector2(-3, -2)

[node name="PlayerSpawner" type="AnimatedSprite2D" parent="." node_paths=PackedStringArray("camera")]
position = Vector2(0, -24)
sprite_frames = SubResource("SpriteFrames_gbniv")
animation = &"idle"
script = ExtResource("8_q8ubn")
character_scene = "res://character/character.tscn"
camera = NodePath("../Camera2D")

[node name="Camera2D" type="Camera2D" parent="."]
process_callback = 0
limit_left = -1800
limit_right = 4500
script = ExtResource("4_q8ubn")
camera_speed = 8.0
zoom_out_threshold = 350.0
zoom_out_damp = 1500.0
max_velocity_offset = Vector2(1000, 600)
ground_offset = 200.0

[node name="Transitioner" type="Node2D" parent="Camera2D"]
script = ExtResource("5_csaot")
left_scene = "res://level/level_scenes/test_level.tscn"
right_scene = "res://level/level_scenes/test_level.tscn"

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera2D"]
libraries = {
&"": SubResource("AnimationLibrary_ksba8")
}

[connection signal="timeout" from="Objects/Rings/Timer" to="Objects/Rings" method="timeout"]

[editable path="Objects/PetalPlacer"]
[editable path="Objects/Rings"]
